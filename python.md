# 命名
## G.NAM.01 使用统一的命名风格
建议
标识符命名风格原则
基于开源或外部代码进行开发或维护时，可以保持原有命名风格
未明确要求的标识符命名风格，自行选择，保持风格统一
小写下划线：模块、包、函数、全局变量、类变量、实例变量、方法名称、函数或方法的参数、局部变量
大驼峰：类、异常
大写下划线：全局常量、类常量
1. 包、模块名使用意义完整的英文描述，采用小写加下划线的风格命名
   1. 包名和模块文件名中不能包含除下划线以外的标点符号和特殊符号，建议使用小写英语单词或者使用几个小写英语单词的组合
2. 类名
   1. 类名通常是名词或名词短语
   2. 可以使用单个英语单词或多个单词的组合
   3. 类名不应该使用动词，也应该避免Data、Info这样的模糊词
3. 函数、方法
   1. 可以使用小写英语单词，一般使用动词
   2. 可以使用单词的组合，一般使用动词、介词和名词，使用单下划线连接单词，所有字母都小写
   3. 如果一个函数不想对外公开，是仅供模块内其他函数调用的辅助函数，建议以单个下划线开头，表示函数是protected的，使用`from module_name import *`时不会导入
4. 类或对象的私有成员一般用单下划线开头；对于需要被继承的基类成员，如果想要防止与派生类成员重名，可用双下划线开头
   1. Python没有严格的似有权限控制，业内约定俗成的用单下划线开头来按时此成员仅供内部使用。双下划线开头的成员会被解释器自动改名，加上类名作为前缀，其作用是防止在类继承场景中出现名字冲突，并不具有权限控制的作用，外部仍然可以访问。双下划线开头的成员应该只在需要避免名字冲突的场景中使用，比如设计为被继承的工具基类。
5. 变量、类的数据成员、函数的参数采用小写加下划线的风格命名
   1. 可以使用小写英语单词，一般使用名词
   2. 可以使用单词组合，使用单下划线连接单词，所有字母都小写
   3. 如果变量名不得不与内置函数、内置模块、标准库名字重合，可以后面加一个下划线以作为区分
6. 常量
   1. 常量应使用大写英文单词或者使用单下划线连接的大写英语单词组合来命名，表示在程序中不需要修改的固定值。常量命名要尽量表达完整的语义
   2. 类常量及枚举命名同样建议以大写加下划线的风格命名。

## G.NAM.02 命名要有明确含义，以提升代码的可读性
建议
1. 命名中若使用了特殊约定或缩写，建议注释说明
2. 命名需要有明确含义，在能够准确表达含义的前提下，应该尽量简短
3. 建议遵循标识符长度正比于标识符的作用域原则。作用域很小且无歧义的情况下，允许使用单字符命名变量，除此以外，避免使用单个字符或字幕与数字的简单组合
4. 对于单个字符命名的场景，不应该使用字符l、I、o等命名，在某些字体中，这些字符与数字1和0难以辨认，如果确实要以l作为变量，使用L替换。

## G.NAM.03 “self”应是实例方法的第一个参数，“cls”应是类方法的第一个参数
建议
类方法是被`@classmethod`装饰的函数
Python语言常规约定
类的实例方法至少要有一个位置参数self，类方法至少要有一个位置参数cls，并且都必须是第一个

## G.NAM.04 避免在无关的标识符或无关的概念之间重用名字，避免因重名而导致的意外赋值和错误引用
建议
Python的函数/类定义和C语言不同，函数/类定义语句实际上是给一个名字赋值，因此重复定义一个函数/类的名字不会导致错误，后定义的会覆盖前面的。但是重复定义很容易掩盖编码问题，也不利于可读性，应予以禁止。Python在解析一个被引用的名字时遵循LEGB顺序（local，enclosed，global，builtin）从内层一直查找到外层。内层定义的变量会遮盖外层的同名变量。
1. 标识符的命名避免和内置函数、内置类以及Python关键字重复
2. 避免重复定义函数、类方法或类
3. 标识符命名避免与当前导入的模块名称重名
4. 避免在函数中定义与参数名称相同的变量，这可能导致潜在的错误

## G.NAM.05 除了需要重写魔法函数、对象之外，不推荐使用双下划线开头且双下划线结尾的标识符来命名一般对象
建议
Python语言的约定，以双下划线开头且结尾的标识符，用来命名Python内部特殊的魔法函数或对象

# 注释
## G.CMT.01 模块文档字符串写在文件的顶部，Shebang和文件编码声明之后，导入部分之前的位置，不需要缩进
建议
文档字符串使用三引号作为定界符，以前导三引号开头，结束三引号要自成一行
模块文档字符串通常可以包含当前模块文件的简要描述以及该模块中的类、函数等信息，这些信息以每个一段的形式摘要描述。详细功能描述建议和上面的总体描述空一行分隔。
文档字符串的第一个摘要行可能与前导三引号在同一行，也可能在下一行
模块文档字符串结束后空一行，然后编写其他内容
## G.CMT.02 类的文档字符串写在类声明所在行的下一行，并向后缩进4个空格
建议
与内部定义的方法、数据成员具有相同的缩进量
对于功能非常明了的类，可使用单行文档字符串，使用三引号作为定界符，并且前导三引号和结束三引号保持在同一行
多行文档字符串使用三引号作为定界符，以前导三引号开头，结束三引号要自成一行，前导三引号不一定要自成一行
类的多行文档字符串的内容通常可以包含其功能描述，实例属性或公共方法，这些信息以每个一段的形式摘要描述。如果该类可能被子类化，并且具有用于子类的附加接口，则该接口应在文档字符串中单独列出。类构造方法的详细细节可以在类文档字符串记录也可以在其自己的文档字符串记录，其他方法的详细细节通过其自己的文档字符串记录。
## G.CMT.03 公共函数的文档字符串写在函数声明所在行的下一行，并向后缩进4个空格
建议
单行/多行文档字符串，三引号同上
公共函数的多行文档字符串内容通常包含功能描述、参数、返回值、异常描述等，信息以每个一段的形式摘要描述。异常描述除描述函数内部抛出的异常外，还应该说明异常的含义及什么条件下抛出该异常。
Google风格，Pycharm reStructedText风格都可，保持一致即可
## P.01 注释跟代码一样重要，应按需注释
尽量通过清晰的软件架构、良好的标识符命名来提高代码可读性；在需要的时候，才辅以注释说明。对晦涩难懂的代码、命名，应该考虑重构而不是添加注释。
修改代码时，也要保证其相关注释的一致性。
注释语言由开发团队统一决定，最擅长、沟通效率最高的语言。
## G.CMT.04 代码的注释位置和格式应该在项目内保持统一
建议
代码的注释位置和格式有两种风格，应在项目内保持统一的风格：
1. 注释应该与其描述的代码保持同样的缩进，放在被注释代码的上方相邻位置，使用#开头，#后面一个空格然后写注释文本
2. 代码行的行尾添加注释，为了提高可读性，行尾注释应该至少离开代码2个空格，#后面一个空格然后写注释文本
## G.CMT.05 正式交付给客户的代码不应包含TODO/FIXME注释
建议
TODO注释一般用来描述已知待改进、待补充的修改点。FIXME注释一般用来描述已知缺陷。都应该有统一风格，方便文本搜索统一处理
在版本开发阶段，可以使用此类注释用于突出标注，交付前应该全部处理掉
## G.CMT.06 文件头注释应该包含版权许可信息
建议
文件头注释应放在模块文档字符串之前，应包含版本许可信息。如果需要在文件头注释中增加其他内容，可以在版权说明的后面进行补充。
版权许可信息建议放在shebang和文件编码声明之后
版权所有 (c) xxxx公司 2012-2020
Copyright (c) xxxx Co., Ltd. 2012-2020. All rights reserved.
1. 年份可以根据实际需要进行修改，前者是文件首次创建年份，后者是最后文件修改年份，二者可以一样。对文件有重大修改时，必须更新后面年份，如特性扩展、重大重构等。
2. 版权所有可以使用子公司
3. 同一项目内，版本许可信息的位置和风格应保持一致

# 格式
## G.FMT.01 程序块应该采用4个空格缩进风格编写
建议
选择结构、循环结构、异常处理结构、函数定义、类定义、成员方法定义、类方法定义、静态方法定义、with块等语法结构，代码相对于头部应该有4个空格的缩进
相同级别的代码应具有相同的缩进量，虽然不影响程序运行，也不允许在逻辑上具有相同缩进层次的代码在视觉上具有不同的缩进量
使用空格和跳格，虽然视觉效果 一样，但禁止在缩进时混合使用跳格和空格，否则程序无法运行，提示错误`SyntaxError: inconsistent use of tabs and spaces in indentation`因此，新项目必须使用纯空格来代替跳格
## G.FMT.02 行宽不超过120个字符
建议
行宽包含代码以及注释等，行宽不宜过长，否则不利于阅读。控制行宽可以间接地引导程序员去缩短函数、变量的命名，减少嵌套的层数，精炼注释，提升代码可读性。建议每行字符数不要超过120个；除非超过120能显著增加可读性，并且不会隐藏信息。较长的语句、表达式或参数以及注释行要进行换行处理。
**例外：**
对于换行导致内容截断，不方便查找、拷贝的字符串（如长URL、命令行等）可以不换行。
## G.FMT.03 合理安排空行
建议
使用空行可以凸显出代码块的相关程度，能提升代码可读性。但是过多的空行并不能带来更多好处，反而可能降低代码的可读性。
1. 减少空行，仅在需要特别凸显代码块逻辑分组时使用连续空行，并且最多连续2个空行，比如顶级的类定义或函数定义之间，需要2个空行
2. 类的方法定义之间空一行
3. 相对独立的逻辑代码块之间，变量说明之后建议空一行

## G.FMT.04 用空格突出关键字和重要信息
建议
建议加空格的场景：
1. 逗号、分号、冒号只在后面加空格
2. 比较操作符，赋值操作符，算数操作符，逻辑操作符等双目操作符的前后加空格
3. `*`、`**`等作为操作符时，前后可以加空格，但若和更低优先级的操作符同时使用并且不涉及括号，则建议前后不加空格
4. **函数参数类型定义时**，冒号前不应使用空格，冒号后需要加空格，**参数有默认值则赋值操作符前后需要空格**。函数返回值类型定义前后建议添加空格

不建议加空格的场景：
1. **函数定义语句中的参数默认值**，调用函数传递参数时使用的等号，建议不加空格
2. 对于包含关系的两个对象用“.”连接时，前后不应加空格
3. 括号内侧，左括号后面和右括号前面，不需要加空格，多重括号之间不必加空格
4. 紧贴索引切片或被调用函数名，开始的括号前，不需要加空格
5. 切片的3个参数之间的冒号前后不需要加空格
6. 行尾不建议加空格

## G.FMT.05 导入部分应该置于模块注释和文档字符串之后，模块全局变量和常量声明之前
建议
如果文件中定义了类似`__all__`、`__version__`这种全局变量，那么导入部分应该放在这类定义的后面，但`__future__`模块的导入例外，它的导入必须放在文档字符串之后，其他内容之前。
## G.FMT.06 每行只能导入一个模块
建议
如果从同一个模块中导入多个对象可以在同一行加载，如果一行代码太长，可以放到元组中，然后换行
## G.FMT.07 导入部分应该按照标准库、第三方库、应用程序自定义模块的顺序排列导入
建议
导入部分按照分组顺序导入，每个分组之间应该留一个空行
每个分组内部，应该按照包的完整路径的字母顺序排列导入
如果文件中包含`__future__`模块的导入，那么该语句应该被放在所有导入的最前面
例外：
1. 针对部分模块不在标准python安装路径下，需要进行导入优先级调整的情况下，被调整模块与其他模块之间的先后顺序可以不满足
2. 针对使用`evenlet.monkey_patch`（猴子补丁）进行模块修改的情况下，被修改模块与其他模块间的先后顺序可以不满足

## G.FMT.08 一行只写一条语句
建议
Python虽然支持分号分隔的多条语句，但编写程序时不建议使用这种风格的排版，推荐一行只写一条语句，并且在行尾不加分号。多条语句在一行的明显缺点是调试时无法单步执行。

## G.FMT.09 合理地运用换行和缩进
建议
当语句过长或可读性不佳时，需要在合适的地方换行。换行时建议将操作符、连接符放在行末，表示“未结束，后续还有”。新行应按照缩进要求进行缩进。
1. 如果一条语句过长，且其中有函数调用、方法调用、类调用或类似的语法，可以采用隐式续行的写法，左括号应跟函数名在同一行，右括号应跟最后一个参数在同一行，然后在圆括号内某个参数后面逗号位置换行，换行后后面几行开始的位置，与同组表达式的第一个左对齐。
2. 如果列表、元组、字典、集合类似的对象的语句过长，建议要么左括号与右括号在同一行，要么在左括号后进行第一次换行，右括号单独成一行。
3. 不建议复杂且较长的表达式，如果一定要使用，建议在每一段后面进行换行，即每段分别独立一行

## G.FMT.10 代码的行外结束符LF和CRLF不应该混用
UNIX系统应使用LF作为行尾结束符，Windows系统应使用CRLF作为行尾结束符